{% doc %}
  @prompt
    this website is off a printing store so i want a section that will display printers on left for desktop and on top for mobile now on right or on below the printer there is a calulatore styled form where the user will input quantity now in the customizer i want option to set rate according to the quantity so i want some options in the customizer: size (length x breadth), quantity and rate (this rate will for this selected size and quanity) so i want multiple so i can provide rate for each size according to each minimum quantity i want like from quanity this to this rate will be this

{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-print-calculator-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    padding: 40px;
    background-color: {{ block.settings.background_color }};
    border-radius: {{ block.settings.border_radius }}px;
  }

  .ai-print-calculator__printers-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .ai-print-calculator__printer-item-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 20px;
    background-color: {{ block.settings.printer_card_bg }};
    border-radius: 8px;
    border: 2px solid transparent;
    transition: border-color 0.3s ease;
  }

  .ai-print-calculator__printer-item-{{ ai_gen_id }}:hover {
    border-color: {{ block.settings.accent_color }};
  }

  .ai-print-calculator__printer-image-{{ ai_gen_id }} {
    width: 80px;
    height: 80px;
    flex-shrink: 0;
  }

  .ai-print-calculator__printer-image-{{ ai_gen_id }} img {
    width: 100%;
    height: 100%;
    object-fit: cover;border-radius: 4px;
  }

  .ai-print-calculator__printer-placeholder-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    background-color: #f4f4f4;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
  }

  .ai-print-calculator__printer-placeholder-{{ ai_gen_id }} svg {
    width: 40px;
    height: 40px;
    color: #999;
  }

  .ai-print-calculator__printer-info-{{ ai_gen_id }} {
    flex-grow: 1;}

  .ai-print-calculator__printer-title-{{ ai_gen_id }} {
    font-size: 18px;
    font-weight: 600;
    margin: 0 0 5px;color: {{ block.settings.text_color }};
  }

  .ai-print-calculator__printer-desc-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.text_color }};
    opacity: 0.8;
    margin: 0;
  }

  .ai-print-calculator__form-section-{{ ai_gen_id }} {
    background-color: {{ block.settings.form_bg_color }};
    padding: 30px;
    border-radius: 12px;
    border: 1px solid {{ block.settings.form_border_color }};
  }

  .ai-print-calculator__form-title-{{ ai_gen_id }} {
    font-size: 24px;
    font-weight: 600;
    margin: 0 0 20px;
    color: {{ block.settings.text_color }};
  }

  .ai-print-calculator__form-group-{{ ai_gen_id }} {
    margin-bottom: 20px;
  }

  .ai-print-calculator__label-{{ ai_gen_id }} {
    display: block;
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 8px;
    color: {{ block.settings.text_color }};
  }

  .ai-print-calculator__select-{{ ai_gen_id }},
  .ai-print-calculator__input-{{ ai_gen_id }} {
    width: 100%;
    padding: 12px 16px;
    border: 1px solid {{ block.settings.input_border_color }};
    border-radius: {{ block.settings.input_border_radius }}px;
    font-size: 16px;
    background-color: white;
  }

  .ai-print-calculator__select-{{ ai_gen_id }}:focus,
  .ai-print-calculator__input-{{ ai_gen_id }}:focus {
    outline: none;
    border-color: {{ block.settings.accent_color }};
  }

  .ai-print-calculator__result-{{ ai_gen_id }} {
    background-color: {{ block.settings.accent_color }};
    color: white;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    margin-top: 20px;
  }

  .ai-print-calculator__result-label-{{ ai_gen_id }} {
    font-size: 14px;
    opacity: 0.9;
    margin: 0 0 5px;
  }

  .ai-print-calculator__result-price-{{ ai_gen_id }} {
    font-size: 28px;
    font-weight: 700;
    margin: 0;}

  .ai-print-calculator__error-{{ ai_gen_id }} {
    background-color: #fee;
    color: #c33;
    padding: 15px;
    border-radius: 8px;
    text-align: center;
    margin-top: 20px;font-size: 14px;
  }

  @media screen and (max-width: 768px) {
    .ai-print-calculator-{{ ai_gen_id }} {
      grid-template-columns: 1fr;gap: 30px;
      padding: 20px;
    }

    .ai-print-calculator__printers-{{ ai_gen_id }} {
      order: 1;
    }

    .ai-print-calculator__form-section-{{ ai_gen_id }} {
      order: 2;padding: 20px;
    }

    .ai-print-calculator__printer-item-{{ ai_gen_id }} {
      padding: 15px;
    }

    .ai-print-calculator__printer-image-{{ ai_gen_id }} {
      width: 60px;
      height: 60px;
    }
  }
{% endstyle %}

<print-calculator-{{ ai_gen_id }}
  class="ai-print-calculator-{{ ai_gen_id }}"
  {{ block.shopify_attributes }}
>
  <div class="ai-print-calculator__printers-{{ ai_gen_id }}">
    {% for i in (1..3) %}
      {% liquid
        assign printer_enabled_key = 'printer_' | append: i | append: '_enabled'
        assign printer_image_key = 'printer_' | append: i | append: '_image'
        assign printer_title_key = 'printer_' | append: i | append: '_title'
        assign printer_desc_key = 'printer_' | append: i | append: '_description'

        assign printer_enabled = block.settings[printer_enabled_key]
        assign printer_image = block.settings[printer_image_key]
        assign printer_title = block.settings[printer_title_key]
        assign printer_desc = block.settings[printer_desc_key]%}

      {% if printer_enabled and printer_title != blank %}
        <div class="ai-print-calculator__printer-item-{{ ai_gen_id }}">
          <div class="ai-print-calculator__printer-image-{{ ai_gen_id }}">
            {% if printer_image %}
              <img
                src="{{ printer_image | image_url: width: 160}}"
                alt="{{ printer_image.alt | escape }}"
                width="160"
                height="160"
                loading="lazy"
              >
            {% else %}
              <div class="ai-print-calculator__printer-placeholder-{{ ai_gen_id }}">
                {{ 'product-1' | placeholder_svg_tag }}
              </div>
            {% endif %}
          </div>
          <div class="ai-print-calculator__printer-info-{{ ai_gen_id }}">
            <h3 class="ai-print-calculator__printer-title-{{ ai_gen_id }}">{{ printer_title }}</h3>
            {% if printer_desc != blank %}
              <p class="ai-print-calculator__printer-desc-{{ ai_gen_id }}">{{ printer_desc }}</p>
            {% endif %}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>

  <div class="ai-print-calculator__form-section-{{ ai_gen_id }}">
    <h2 class="ai-print-calculator__form-title-{{ ai_gen_id }}">{{ block.settings.calculator_title }}</h2>
    
    <div class="ai-print-calculator__form-group-{{ ai_gen_id }}">
      <label class="ai-print-calculator__label-{{ ai_gen_id }}" for="size-select-{{ ai_gen_id }}">
        Select Size
      </label>
      <select
        id="size-select-{{ ai_gen_id }}"
        class="ai-print-calculator__select-{{ ai_gen_id }}"
        data-calculator-size>
        <option value="">Choose a size</option>
        {% for i in (1..5) %}
          {% liquid
            assign size_enabled_key = 'size_' | append: i | append: '_enabled'
            assign size_length_key = 'size_' | append: i | append: '_length'
            assign size_breadth_key = 'size_' | append: i | append: '_breadth'

            assign size_enabled = block.settings[size_enabled_key]
            assign size_length = block.settings[size_length_key]
            assign size_breadth = block.settings[size_breadth_key]
          %}

          {% if size_enabled and size_length != blank and size_breadth != blank %}
            <option value="{{ size_length }}x{{ size_breadth }}">
              {{ size_length }} x {{ size_breadth }}
            </option>
          {% endif %}
        {% endfor %}
      </select>
    </div>

    <div class="ai-print-calculator__form-group-{{ ai_gen_id }}">
      <label class="ai-print-calculator__label-{{ ai_gen_id }}" for="quantity-input-{{ ai_gen_id }}">
        Quantity
      </label>
      <input
        type="number"
        id="quantity-input-{{ ai_gen_id }}"
        class="ai-print-calculator__input-{{ ai_gen_id }}"
        min="1"
        value="1"
        data-calculator-quantity
      >
    </div>

    <div id="calculator-result-{{ ai_gen_id }}" style="display: none;">
      <div class="ai-print-calculator__result-{{ ai_gen_id }}">
        <p class="ai-print-calculator__result-label-{{ ai_gen_id }}">Total Price</p>
        <p class="ai-print-calculator__result-price-{{ ai_gen_id }}" data-result-price>$0.00</p>
      </div>
    </div>

    <div id="calculator-error-{{ ai_gen_id }}" class="ai-print-calculator__error-{{ ai_gen_id }}" style="display: none;">
      <p data-error-message>Please select a size and enter quantity</p>
    </div>
  </div>
</print-calculator-{{ ai_gen_id }}><script>
  (function() {
    class PrintCalculator{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
        this.pricingData = this.buildPricingData();}

      connectedCallback() {
        this.sizeSelect = this.querySelector('[data-calculator-size]');
        this.quantityInput = this.querySelector('[data-calculator-quantity]');
        this.resultDiv = this.querySelector('#calculator-result-{{ ai_gen_id }}');
        this.errorDiv = this.querySelector('#calculator-error-{{ ai_gen_id }}');
        this.priceDisplay = this.querySelector('[data-result-price]');
        this.errorMessage = this.querySelector('[data-error-message]');

        this.setupEventListeners();this.calculate();
      }

      buildPricingData() {
        const pricing = {};
        
        {% for i in (1..10) %}
          {% liquid
            assign rate_enabled_key = 'rate_' | append: i | append: '_enabled'
            assign rate_size_key = 'rate_' | append: i | append: '_size'
            assign rate_min_qty_key = 'rate_' | append: i | append: '_min_quantity'
            assign rate_max_qty_key = 'rate_' | append: i | append: '_max_quantity'
            assign rate_price_key = 'rate_' | append: i | append: '_price'

            assign rate_enabled = block.settings[rate_enabled_key]
            assign rate_size = block.settings[rate_size_key]
            assign rate_min_qty = block.settings[rate_min_qty_key]
            assign rate_max_qty = block.settings[rate_max_qty_key]
            assign rate_price = block.settings[rate_price_key]
          %}

          {% if rate_enabled and rate_size != blank and rate_min_qty != blank and rate_price != blank %}
            if (!pricing['{{ rate_size }}']) {
              pricing['{{ rate_size }}'] = [];
            }
            pricing['{{ rate_size }}'].push({
              minQty: {{ rate_min_qty }},
              maxQty: {% if rate_max_qty != blank %}{{ rate_max_qty }}{% else %}Infinity{% endif %},
              price: {{ rate_price }}
            });
          {% endif %}
        {% endfor %}

        Object.keys(pricing).forEach(size => {
          pricing[size].sort((a, b) => a.minQty - b.minQty);
        });

        return pricing;
      }

      setupEventListeners() {
        this.sizeSelect.addEventListener('change', () => this.calculate());
        this.quantityInput.addEventListener('input', () => this.calculate());}

      calculate() {
        const selectedSize = this.sizeSelect.value;
        const quantity = parseInt(this.quantityInput.value) || 0;

        this.hideResults();

        if (!selectedSize || quantity <= 0) {
          this.showError('Please select a size and enter a valid quantity');
          return;
        }

        const sizeRates = this.pricingData[selectedSize];
        if (!sizeRates || sizeRates.length === 0) {
          this.showError('No pricing available for selected size');
          return;
        }

        const applicableRate = sizeRates.find(rate =>
          quantity >= rate.minQty && quantity <= rate.maxQty
        );

        if (!applicableRate) {
          this.showError('No pricing available for this quantity range');
          return;
        }

        const totalPrice = quantity * applicableRate.price;
        this.showResult(totalPrice);
      }

      showResult(price) {
        this.priceDisplay.textContent = '$' + price.toFixed(2);
        this.resultDiv.style.display = 'block';
        this.errorDiv.style.display = 'none';
      }

      showError(message) {
        this.errorMessage.textContent = message;
        this.errorDiv.style.display = 'block';
        this.resultDiv.style.display = 'none';
      }

      hideResults() {
        this.resultDiv.style.display = 'none';
        this.errorDiv.style.display = 'none';
      }
    }

    customElements.define('print-calculator-{{ ai_gen_id }}', PrintCalculator{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Print Calculator",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "General Settings"
    },
    {
      "type": "text",
      "id": "calculator_title",
      "label": "Calculator title",
      "default": "Print Cost Calculator"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#333333"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color",
      "default": "#007bff"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Form Styling"
    },
    {
      "type": "color",
      "id": "form_bg_color",
      "label": "Form background color",
      "default": "#f8f9fa"
    },
    {
      "type": "color",
      "id": "form_border_color",
      "label": "Form border color",
      "default": "#dee2e6"
    },
    {
      "type": "color",
      "id": "input_border_color",
      "label": "Input border color",
      "default": "#ced4da"
    },
    {
      "type": "range",
      "id": "input_border_radius",
      "min": 0,
      "max": 15,
      "step": 1,
      "unit": "px",
      "label": "Input border radius",
      "default": 4
    },
    {
      "type": "color",
      "id": "printer_card_bg",
      "label": "Printer card background",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Printer1"
    },
    {
      "type": "checkbox",
      "id": "printer_1_enabled",
      "label": "Enable printer 1",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "printer_1_image",
      "label": "Printer image"
    },
    {
      "type": "text",
      "id": "printer_1_title",
      "label": "Printer name",
      "default": "HP LaserJet Pro"
    },
    {
      "type": "textarea",
      "id": "printer_1_description",
      "label": "Printer description",
      "default": "High-quality laser printing for professional documents"
    },
    {
      "type": "header",
      "content": "Printer 2"
    },
    {
      "type": "checkbox",
      "id": "printer_2_enabled",
      "label": "Enable printer 2"
    },
    {
      "type": "image_picker",
      "id": "printer_2_image",
      "label": "Printer image"
    },
    {
      "type": "text",
      "id": "printer_2_title",
      "label": "Printer name"
    },
    {
      "type": "textarea",
      "id": "printer_2_description",
      "label": "Printer description"
    },
    {
      "type": "header",
      "content": "Printer 3"
    },
    {
      "type": "checkbox",
      "id": "printer_3_enabled",
      "label": "Enable printer 3"
    },
    {
      "type": "image_picker",
      "id": "printer_3_image",
      "label": "Printer image"
    },
    {
      "type": "text",
      "id": "printer_3_title",
      "label": "Printer name"
    },
    {
      "type": "textarea",
      "id": "printer_3_description",
      "label": "Printer description"
    },
    {
      "type": "header",
      "content": "Available Sizes"
    },
    {
      "type": "checkbox",
      "id": "size_1_enabled",
      "label": "Enable size 1",
      "default": true
    },
    {
      "type": "text",
      "id": "size_1_length",
      "label": "Size1 length",
      "default": "8.5"
    },
    {
      "type": "text",
      "id": "size_1_breadth",
      "label": "Size 1 breadth",
      "default": "11"
    },
    {
      "type": "checkbox",
      "id": "size_2_enabled",
      "label": "Enable size 2",
      "default": true
    },
    {
      "type": "text",
      "id": "size_2_length",
      "label": "Size 2 length",
      "default": "11"
    },
    {
      "type": "text",
      "id": "size_2_breadth",
      "label": "Size 2 breadth",
      "default": "17"
    },
    {
      "type": "checkbox",
      "id": "size_3_enabled",
      "label": "Enable size 3"
    },
    {
      "type": "text",
      "id": "size_3_length",
      "label": "Size 3 length"
    },
    {
      "type": "text",
      "id": "size_3_breadth",
      "label": "Size 3 breadth"
    },
    {
      "type": "checkbox",
      "id": "size_4_enabled",
      "label": "Enable size 4"
    },
    {
      "type": "text",
      "id": "size_4_length",
      "label": "Size 4 length"
    },
    {
      "type": "text",
      "id": "size_4_breadth",
      "label": "Size 4 breadth"
    },
    {
      "type": "checkbox",
      "id": "size_5_enabled",
      "label": "Enable size 5"
    },
    {
      "type": "text",
      "id": "size_5_length",
      "label": "Size 5 length"
    },
    {
      "type": "text",
      "id": "size_5_breadth",
      "label": "Size 5 breadth"
    },
    {
      "type": "header",
      "content": "Pricing Rate1"
    },
    {
      "type": "checkbox",
      "id": "rate_1_enabled",
      "label": "Enable rate 1",
      "default": true
    },
    {
      "type": "text",
      "id": "rate_1_size",
      "label": "Size (length x breadth)",
      "default": "8.5x11"
    },
    {
      "type": "text",
      "id": "rate_1_min_quantity",
      "label": "Minimum quantity",
      "default": "1"
    },
    {
      "type": "text",
      "id": "rate_1_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_1_price",
      "label": "Price per unit",
      "default": "0.10"
    },
    {
      "type": "header",
      "content": "Pricing Rate 2"
    },
    {
      "type": "checkbox",
      "id": "rate_2_enabled",
      "label": "Enable rate 2"
    },
    {
      "type": "text",
      "id": "rate_2_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_2_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_2_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_2_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 3"
    },
    {
      "type": "checkbox",
      "id": "rate_3_enabled",
      "label": "Enable rate 3"
    },
    {
      "type": "text",
      "id": "rate_3_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_3_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_3_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_3_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 4"
    },
    {
      "type": "checkbox",
      "id": "rate_4_enabled",
      "label": "Enable rate 4"
    },
    {
      "type": "text",
      "id": "rate_4_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_4_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_4_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_4_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 5"
    },
    {
      "type": "checkbox",
      "id": "rate_5_enabled",
      "label": "Enable rate 5"
    },
    {
      "type": "text",
      "id": "rate_5_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_5_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_5_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_5_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 6"
    },
    {
      "type": "checkbox",
      "id": "rate_6_enabled",
      "label": "Enable rate 6"
    },
    {
      "type": "text",
      "id": "rate_6_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_6_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_6_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_6_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 7"
    },
    {
      "type": "checkbox",
      "id": "rate_7_enabled",
      "label": "Enable rate 7"
    },
    {
      "type": "text",
      "id": "rate_7_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_7_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_7_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_7_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 8"
    },
    {
      "type": "checkbox",
      "id": "rate_8_enabled",
      "label": "Enable rate 8"
    },
    {
      "type": "text",
      "id": "rate_8_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_8_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_8_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_8_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 9"
    },
    {
      "type": "checkbox",
      "id": "rate_9_enabled",
      "label": "Enable rate 9"
    },
    {
      "type": "text",
      "id": "rate_9_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_9_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_9_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_9_price",
      "label": "Price per unit"
    },
    {
      "type": "header",
      "content": "Pricing Rate 10"
    },
    {
      "type": "checkbox",
      "id": "rate_10_enabled",
      "label": "Enable rate 10"
    },
    {
      "type": "text",
      "id": "rate_10_size",
      "label": "Size (length x breadth)"
    },
    {
      "type": "text",
      "id": "rate_10_min_quantity",
      "label": "Minimum quantity"
    },
    {
      "type": "text",
      "id": "rate_10_max_quantity",
      "label": "Maximum quantity"
    },
    {
      "type": "text",
      "id": "rate_10_price",
      "label": "Price per unit"
    }
  ],
  "presets": [
    {
      "name": "Print Calculator"
    }
  ]
}
{% endschema %}