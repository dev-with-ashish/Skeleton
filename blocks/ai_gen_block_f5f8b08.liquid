{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-product-block-{{ ai_gen_id }} {
    background-color: {{ block.settings.background_color }};
    color: {{ block.settings.text_color }};
    padding: {{ block.settings.padding }}px;
    border-radius: {{ block.settings.border_radius }}px;
    font-family: {{ settings.type_primary_font.family }}, {{ settings.type_primary_font.fallback_families }};
    font-weight: {{ settings.type_primary_font.weight }};
  }

  .ai-product-content-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .ai-product-images-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .ai-product-main-image-{{ ai_gen_id }} {
    width: 100%;
    border-radius: {{ block.settings.image_border_radius }}px;
    overflow: hidden;
    background-color: {{ block.settings.image_background }};
  }

  .ai-product-main-image-{{ ai_gen_id }} img {
    width: 100%;
    height: auto;
    display: block;
  }

  .ai-product-thumbnails-{{ ai_gen_id }} {
    display: flex;
    gap: 12px;
    overflow-x: auto;
  }

  .ai-product-thumbnail-{{ ai_gen_id }} {
    width: 80px;
    height: 80px;
    border-radius: {{ block.settings.image_border_radius }}px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.3s ease;
    flex-shrink: 0;
  }

  .ai-product-thumbnail-{{ ai_gen_id }}.active {
    border-color: {{ block.settings.accent_color }};
  }

  .ai-product-thumbnail-{{ ai_gen_id }} img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .ai-product-info-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .ai-product-title-{{ ai_gen_id }} {
    font-size: {{ block.settings.title_size }}px;
    font-weight: 700;
    margin: 0;
    color: {{ block.settings.text_color }};
  }

  .ai-product-brand-{{ ai_gen_id }} {
    font-size: {{ block.settings.brand_size }}px;
    color: {{ block.settings.accent_color }};
    margin: 0;
  }

  .ai-product-rating-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .ai-product-stars-{{ ai_gen_id }} {
    display: flex;
    gap: 2px;
  }

  .ai-product-star-{{ ai_gen_id }} {
    width: 16px;
    height: 16px;
    color: {{ block.settings.star_color }};
  }

  .ai-product-rating-text-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.muted_text_color }};
  }

  .ai-product-price-{{ ai_gen_id }} {
    font-size: {{ block.settings.price_size }}px;
    font-weight: 700;
    color: {{ block.settings.price_color }};
    margin: 0;
  }

  .ai-product-description-{{ ai_gen_id }} {
    font-size: {{ block.settings.description_size }}px;
    line-height: 1.6;
    color: {{ block.settings.text_color }};
  }

  .ai-product-sku-{{ ai_gen_id }} {
    font-size: 14px;
    color: {{ block.settings.muted_text_color }};
  }

  .ai-product-trust-indicators-{{ ai_gen_id }} {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 24px;
    padding: 20px;
    background-color: {{ block.settings.trust_background }};
    border-radius: {{ block.settings.border_radius }}px;
    border: 1px solid {{ block.settings.border_color }};
    flex-wrap: wrap;
  }

  .ai-product-trust-item-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 8px;
    flex: 1;
  }

  .ai-product-trust-connector-{{ ai_gen_id }} {
    font-size: 16px;
    color: {{ block.settings.muted_text_color }};
    font-weight: 500;
  }

  .ai-product-trust-icon-{{ ai_gen_id }} {
    width: 32px;
    height: 32px;
    color: {{ block.settings.accent_color }};
  }

  .ai-product-trust-title-{{ ai_gen_id }} {
    font-size: 14px;
    font-weight: 600;
    color: {{ block.settings.text_color }};
    margin: 0;
  }

  .ai-product-trust-desc-{{ ai_gen_id }} {
    font-size: 12px;
    color: {{ block.settings.muted_text_color }};
    margin: 0;
  }

  .ai-product-buttons-{{ ai_gen_id }} {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .ai-product-button-{{ ai_gen_id }} {
    padding: 16px 24px;
    border: none;
    border-radius: {{ block.settings.button_border_radius }}px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    text-align: center;
    display: inline-block;
  }

  .ai-product-button-primary-{{ ai_gen_id }} {
    background-color: {{ block.settings.primary_button_color }};
    color: {{ block.settings.primary_button_text }};
  }

  .ai-product-button-primary-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.primary_button_hover }};
  }

  .ai-product-button-secondary-{{ ai_gen_id }} {
    background-color: {{ block.settings.secondary_button_color }};
    color: {{ block.settings.secondary_button_text }};
    border: 1px solid {{ block.settings.border_color }};
  }

  .ai-product-button-secondary-{{ ai_gen_id }}:hover {
    background-color: {{ block.settings.secondary_button_hover }};
  }

  .ai-product-availability-{{ ai_gen_id }} {
    font-size: 14px;
    padding: 8px 12px;
    border-radius: 4px;
    display: inline-block;
  }

  .ai-product-availability-in-stock-{{ ai_gen_id }} {
    background-color: rgba(34, 197, 94, 0.1);
    color: #22c55e;
  }

  .ai-product-availability-out-of-stock-{{ ai_gen_id }} {
    background-color: rgba(239, 68, 68, 0.1);
    color: #ef4444;
  }

  @media screen and (max-width: 768px) {
    .ai-product-content-{{ ai_gen_id }} {
      grid-template-columns: 1fr;
      gap: 24px;
    }

    .ai-product-trust-indicators-{{ ai_gen_id }} {
      flex-direction: column;
      gap: 16px;
    }

    .ai-product-trust-item-{{ ai_gen_id }} {
      flex-direction: row;
      text-align: left;
      justify-content: center;
    }

    .ai-product-trust-connector-{{ ai_gen_id }} {
      display: none;
    }
  }
{% endstyle %}

<div class="ai-product-block-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-product-content-{{ ai_gen_id }}">
    <div class="ai-product-images-{{ ai_gen_id }}">
      <div class="ai-product-main-image-{{ ai_gen_id }}">
        {% if product.featured_image %}
          <img
            src="{{ product.featured_image | image_url: width: 600 }}"
            alt="{{ product.featured_image.alt | escape }}"
            width="600"
            height="600"
            loading="lazy"
          >
        {% else %}
          <div class="ai-product-image-placeholder-{{ ai_gen_id }}">
            {{ 'product-1' | placeholder_svg_tag }}
          </div>
        {% endif %}
      </div>
      
      {% if product.images.size > 1 %}
        <div class="ai-product-thumbnails-{{ ai_gen_id }}">
          {% for image in product.images limit: 5 %}
            <div class="ai-product-thumbnail-{{ ai_gen_id }} {% if forloop.first %}active{% endif %}">
              <img
                src="{{ image | image_url: width: 100 }}"
                alt="{{ image.alt | escape }}"
                width="100"
                height="100"
                loading="lazy"
              >
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <div class="ai-product-info-{{ ai_gen_id }}">
      {% if product.vendor != blank %}
        <p class="ai-product-brand-{{ ai_gen_id }}">{{ product.vendor }}</p>
      {% endif %}

      <h1 class="ai-product-title-{{ ai_gen_id }}">{{ product.title | default: "Product Name" }}</h1>

      {% if product.metafields.reviews.rating.value != blank %}
        <div class="ai-product-rating-{{ ai_gen_id }}">
          <div class="ai-product-stars-{{ ai_gen_id }}">
            {% assign rating = product.metafields.reviews.rating.value %}
            {% for i in (1..5) %}
              <svg class="ai-product-star-{{ ai_gen_id }}" fill="{% if i <= rating %}currentColor{% else %}none{% endif %}" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
              </svg>
            {% endfor %}
          </div>
          <span class="ai-product-rating-text-{{ ai_gen_id }}">
            {{ rating }} ({{ product.metafields.reviews.rating_count.value | default: "0" }} reviews)
          </span>
        </div>
      {% endif %}

      <p class="ai-product-price-{{ ai_gen_id }}">
        {{ product.price | default: 2999 | money }}
        {% if product.compare_at_price > product.price %}
          <s style="color: {{ block.settings.muted_text_color }}; font-weight: normal;">{{ product.compare_at_price | money }}</s>
        {% endif %}
      </p>

      {% if product.available %}
        <span class="ai-product-availability-{{ ai_gen_id }} ai-product-availability-in-stock-{{ ai_gen_id }}">In Stock</span>
      {% else %}
        <span class="ai-product-availability-{{ ai_gen_id }} ai-product-availability-out-of-stock-{{ ai_gen_id }}">Out of Stock</span>
      {% endif %}

      {% if product.description != blank %}
        <div class="ai-product-description-{{ ai_gen_id }}">
          {{ product.description | truncate: 200 }}
        </div>
      {% endif %}

      {% if product.selected_variant.sku != blank %}
        <p class="ai-product-sku-{{ ai_gen_id }}">SKU: {{ product.selected_variant.sku }}</p>
      {% endif %}

      <div class="ai-product-trust-indicators-{{ ai_gen_id }}">
        <div class="ai-product-trust-item-{{ ai_gen_id }}">
          <svg class="ai-product-trust-icon-{{ ai_gen_id }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M9 9l3-3 3 3"></path>
          </svg>
          <div>
            <h4 class="ai-product-trust-title-{{ ai_gen_id }}">Open Box COD</h4>
            <p class="ai-product-trust-desc-{{ ai_gen_id }}">Check before payment</p>
          </div>
        </div>

        <span class="ai-product-trust-connector-{{ ai_gen_id }}">{{ block.settings.connector_text }}</span>

        <div class="ai-product-trust-item-{{ ai_gen_id }}">
          <svg class="ai-product-trust-icon-{{ ai_gen_id }}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
          </svg>
          <div>
            <h4 class="ai-product-trust-title-{{ ai_gen_id }}">InStore Pickup</h4>
            <p class="ai-product-trust-desc-{{ ai_gen_id }}">Collect from store</p>
          </div>
        </div>
      </div>

      <div class="ai-product-buttons-{{ ai_gen_id }}">
        <button class="ai-product-button-{{ ai_gen_id }} ai-product-button-primary-{{ ai_gen_id }}">
          Buy Now
        </button>
        <button class="ai-product-button-{{ ai_gen_id }} ai-product-button-secondary-{{ ai_gen_id }}">
          Add to Cart
        </button>
      </div>
    </div>
  </div>
</div>

{% assign v = product.selected_or_first_available_variant %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "@id": {{ canonical_url | append: "#product" | json }},
  "name": {{ product.title | json }},
  "image": [
    {% if product.images.size > 0 %}
      {% for m in product.images limit: 10 %}
        {{ m | image_url: width: 1200 | json }}{% unless forloop.last %}, {% endunless %}
      {% endfor %}
    {% else %}
      {{ product.featured_image | image_url: width: 1200 | json }}
    {% endif %}
  ],
  "description": {{ product.description | strip_html | truncate: 500 | json }},
  "sku": {{ v.sku | default: "" | json }},
  "brand": { "@type": "Brand", "name": {{ product.vendor | default: shop.name | json }} },
  "offers": {
    "@type": "Offer",
    "url": {{ canonical_url | json }},
    "priceCurrency": {{ shop.currency | json }},
    "price": {{ v.price | divided_by: 100.0 | round: 2 }},
    "availability": "{% if v.available %}https://schema.org/InStock{% else %}https://schema.org/OutOfStock{% endif %}",
    "itemCondition": "https://schema.org/NewCondition",
    "seller": { "@type": "Organization", "name": {{ shop.name | json }} },
    "priceValidUntil": {{ 'now' | date: '%s' | plus: 2592000 | date: '%Y-%m-%d' | json }}
  }
}
</script>



{% schema %}
{
  "name": "Product showcase",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Trust indicators"
    },
    {
      "type": "select",
      "id": "connector_text",
      "label": "Connector text",
      "options": [
        {
          "value": "or",
          "label": "or"
        },
        {
          "value": "/",
          "label": "/"
        },
        {
          "value": "•",
          "label": "•"
        },
        {
          "value": "|",
          "label": "|"
        },
        {
          "value": "alternatively",
          "label": "alternatively"
        },
        {
          "value": "also",
          "label": "also"
        }
      ],
      "default": "or"
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "muted_text_color",
      "label": "Muted text color",
      "default": "#a0a0a0"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent color",
      "default": "#3b82f6"
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Price color",
      "default": "#10b981"
    },
    {
      "type": "color",
      "id": "star_color",
      "label": "Star color",
      "default": "#fbbf24"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border color",
      "default": "#374151"
    },
    {
      "type": "color",
      "id": "image_background",
      "label": "Image background",
      "default": "#2d2d2d"
    },
    {
      "type": "color",
      "id": "trust_background",
      "label": "Trust indicators background",
      "default": "#262626"
    },
    {
      "type": "header",
      "content": "Button colors"
    },
    {
      "type": "color",
      "id": "primary_button_color",
      "label": "Primary button background",
      "default": "#3b82f6"
    },
    {
      "type": "color",
      "id": "primary_button_text",
      "label": "Primary button text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "primary_button_hover",
      "label": "Primary button hover",
      "default": "#2563eb"
    },
    {
      "type": "color",
      "id": "secondary_button_color",
      "label": "Secondary button background",
      "default": "transparent"
    },
    {
      "type": "color",
      "id": "secondary_button_text",
      "label": "Secondary button text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "secondary_button_hover",
      "label": "Secondary button hover",
      "default": "#374151"
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 20,
      "max": 48,
      "step": 2,
      "unit": "px",
      "label": "Title size",
      "default": 32
    },
    {
      "type": "range",
      "id": "brand_size",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Brand size",
      "default": 16
    },
    {
      "type": "range",
      "id": "price_size",
      "min": 18,
      "max": 36,
      "step": 2,
      "unit": "px",
      "label": "Price size",
      "default": 24
    },
    {
      "type": "range",
      "id": "description_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Description size",
      "default": 16
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "padding",
      "min": 20,
      "max": 80,
      "step": 4,
      "unit": "px",
      "label": "Block padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 12
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Image border radius",
      "default": 8
    },
    {
      "type": "range",
      "id": "button_border_radius",
      "min": 0,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Button border radius",
      "default": 8
    }
  ],
  "presets": [
    {
      "name": "Product showcase"
    }
  ]
}
{% endschema %}